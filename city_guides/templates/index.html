prlona<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>City Microguides â€” Budget Picks</title>
  <link rel="stylesheet" href="/static/styles.css?v=6">
  <!-- Tailwind Play CDN (for rapid prototyping, replace with built CSS for production) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Optional: DaisyUI base styles via CDN (useful for components) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daisyui@2.51.6/dist/full.css">
  <!-- Flowbite JS (UI components that require JS) -->
  <script src="https://cdn.jsdelivr.net/npm/flowbite@1.6.5/dist/flowbite.min.js"></script>
</head>
<body>
  <div class="wrap">
    <div class="logo-container">
      <img src="/static/marcos.png" alt="Marco's Micro City Guides Logo" class="logo" style="width: 260px; height: auto; max-width:40%;" />
    </div>
      <!-- Hamburger menu for tools -->
      <button id="hamburgerBtn" aria-label="Open menu" class="hamburger fixed top-4 right-4 p-2 bg-white/80 rounded-lg shadow">â˜°</button>
      <div id="hamburgerMenu" class="fixed top-12 right-4 bg-white border rounded-lg shadow p-3" style="display:none; min-width:180px; z-index:60">
        <a id="transportLink" href="/transport" class="block py-2 px-2 hover:bg-gray-100 italic font-semibold">ğŸšŒ Public Transport</a>
        <a href="/tools/currency" class="block py-2 px-2 hover:bg-gray-100">ğŸª™ Currency Converter</a>
        <a href="#" class="block py-2 px-2 hover:bg-gray-100">âš™ï¸ Settings (coming)</a>
        <a href="/version" class="block py-2 px-2 hover:bg-gray-100">ğŸ” Debug /version</a>
      </div>
    <div class="page-hero">
      <h1>AI-Powered City Exploration</h1>
      <p>Chat with Marco, your AI travel guide, to discover neighborhoods and get personalized recommendations for your perfect city adventure!</p>
    </div>

   <!-- Search Section - Reorganized Flow -->
<section class="search-section bg-white rounded-lg shadow-md p-6 mb-6">
  
  <!-- Weather widget: now at the very top of the search card -->
  <section id="weather" class="weather-section mb-4 bg-white/80 border border-blue-100 rounded-xl shadow p-4 flex items-center gap-4" style="display:none;">
    <div id="weather-icon" style="font-size:2.2em;"></div>
    <div>
      <div id="weather-summary" class="font-semibold text-lg"></div>
      <div id="weather-details" class="text-sm text-gray-600"></div>
    </div>
  </section>

  <!-- Step 1: City Input -->
  <div class="city-input-section mb-4">
    <label for="city" class="block text-sm font-medium text-gray-700 mb-1">
      ğŸ“ Where are you going?
    </label>
    <div class="relative">
      <input 
        type="text" 
        id="city" 
        name="city" 
        placeholder="Type a city (e.g., Lisbon, Portugal)"
        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
        autocomplete="off"
      />
      <div id="city-suggestions" class="absolute z-50 w-full bg-white border border-gray-200 rounded-lg shadow-lg mt-1 hidden"></div>
    </div>
  </div>
  
  <!-- Step 2: Neighborhood Discovery (appears after city selected) -->
  <div id="neighborhoodControls" class="neighborhood-section mb-4 hidden">
    <!-- Populated by JavaScript -->
  </div>
  
  <!-- Step 3: Category Chips -->
  <div class="category-section mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2">
      ğŸ” What are you looking for?
    </label>
    <div id="suggestionChips" class="flex flex-wrap gap-2">
      <!-- Populated by JavaScript -->
    </div>
  </div>
  
  <!-- Hidden fields -->
  <input type="hidden" id="user_lat" name="user_lat" />
  <input type="hidden" id="user_lon" name="user_lon" />
  <input type="hidden" id="query" name="query" />
  <input type="hidden" id="neighborhood_id" name="neighborhood_id" />
  <input type="hidden" id="neighborhood_bbox" name="neighborhood_bbox" />
  
  <!-- Step 4: Ask Marco Button -->
  <div class="ask-marco-section mt-4">
    <button
      type="button"
      id="askMarcoBtn"
      disabled
      class="w-full md:w-auto px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition"
    >
      ğŸ§­ Ask Marco
    </button>
    <p id="marcoHint" class="text-xs text-gray-500 mt-1">
      Select a city to start chatting with Marco
    </p>
  </div>

  <!-- Collapse Button -->
  <div class="text-center mt-4">
    <button id="toggleSearchArea" class="px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-200 hover:text-gray-900 transition">
      Minimize Search
    </button>
  </div>

</section>

<!-- Expanded Marco Chat (replaces results section) -->
<section id="marcoChatSection" class="marco-chat-expanded bg-white rounded-lg shadow-md p-6 mb-6" style="display:none;">
  <div class="marco-chat-header-expanded mb-4">
    <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
      ğŸ§­ Marco the Explorer
      <span class="text-sm font-normal text-gray-600">- Your AI travel guide</span>
    </h2>
  </div>
  <div id="chatMessagesExpanded" class="chat-messages-expanded bg-gray-50 rounded-lg p-4 mb-4 min-h-[300px] max-h-[500px] overflow-y-auto">
    <div class="message bot">Hello! I'm Marco, your AI travel guide. Select a city above and ask me anything about your destination!</div>
  </div>
  <div id="chatChipsExpanded" class="chat-chips mb-4"></div>
  <div class="chat-input-group flex gap-2">
    <input id="chatInputExpanded" placeholder="Ask Marco about neighborhoods, food, activities..." class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" />
    <button id="chatSendExpanded" class="px-6 py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition">Send</button>
  </div>
</section>

    <section id="contact-info" class="contact-info">
      <h2>Contact Information</h2>
      <p>If you need to reach us, call:</p>
      <p><a href="{{ phone }}" class="phone-link">{{ phone }}</a></p>
    </section>
  </div>

  <div style="position:fixed;bottom:18px;left:18px;z-index:60;font-size:12px;color:#666;">
    {% if GROQ_ENABLED %}
      <span style="background:#e6fffa;padding:6px;border-radius:6px;border:1px solid #c6f6d5;color:#065f46;">Marco: Groq enabled</span>
    {% else %}
      <span style="background:#fffbeb;padding:6px;border-radius:6px;border:1px solid #fef3c7;color:#92400e;">Marco: fallback mode (no key)</span>
    {% endif %}
  </div>

  <script src="/static/main.js?v=8"></script>
</body>
</html>
